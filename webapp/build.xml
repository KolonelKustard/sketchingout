<?xml version="1.0" encoding="UTF-8"?>

<project name="consequences" default="compile" basedir=".">
	<description>Consequences Web Application</description>

	<property name="src" value="WEB-INF/src"/>
	<property name="dest" value="WEB-INF/classes"/>
	<property name="catalina_work" value="work"/>
	<property environment="env"/>
	
	<target name="makedirs">
		<mkdir dir="${dest}"/>
	</target>
	
	<target name="clean">
		<delete dir="${dest}"/>
		<delete dir="${catalina_work}"/>
	</target>
	
	<target name="compile" depends="makedirs" description="Compiles the web app">
		<javac srcdir="${src}" destdir="${dest}" classpath="servlet.jar">
			<classpath>
				<fileset dir="${env.CATALINA_HOME}/common/lib/">
					<include name="*.jar"/>
				</fileset>
			</classpath>
		</javac>
	</target>
	
	<target name="rebuild" depends="clean, compile"/>
	
	<target name="start_tomcat">
		<exec executable="${env.CATALINA_HOME}/bin/startup.bat" spawn="true"/>
	</target>
	
	<target name="stop_tomcat">
		<exec executable="${env.CATALINA_HOME}/bin/shutdown.bat"/>
	</target>
	
	<target name="xml2swf" depends="compile">
		<java classname="com.totalchange.consequences.ImageParser" fork="yes">
			<arg line="${args}"/>
			<classpath>
				<pathelement path="${dest}"/>
				<fileset dir="${env.CATALINA_HOME}/common/lib/">
					<include name="*.jar"/>
				</fileset>
			</classpath>
		</java>
	</target>
</project>